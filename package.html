<!DOCTYPE html>
<html lang="en">
<head>
    <title>Mayil Taxi - Package Trip</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="1.png">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>

        :root {
            --primary: #ffbf00;
            --secondary: #212529;
            --light-gray: #f8f9fa;
        }

        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .navbar-brand img {
            max-height: 50px;
        }
        .booking-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 40px;
        }
        .logo-container {
            text-align: center;
            margin: 20px 0;
        }

        .logo-container img {
            max-height: 250px;
        }

        .calculator-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 40px;
        }

        #map {
          height: 300px;
          width: 100%;
          border-radius: 10px;
          margin-bottom: 20px;
      }

      /* Center and reduce width on larger screens */
      @media (min-width: 768px) {
          #map {
              width: 50%;
              margin: 0 auto 20px auto; /* top: 0, horizontal: auto, bottom: 20px */
          }
      }
        .btn-calculate {
            background-color: var(--secondary);
            color: white;
            border: none;

        }

        .btn-calculate:hover {
            background-color: #343a40;
            color: var(--primary);
        }

        .btn-reset {
            background-color: #dc3545;
            color: white;
            border: none;
        }

        .btn-reset:hover {
            background-color: #c82333;
        }

        .results {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--primary);
        }


        /* Footer styles */
        .footer {
            background-color: var(--secondary);
            color: white;
            padding: 50px 0 20px;
            width: 100vw;
            margin-left: calc(-50vw + 50%);
            margin-right: calc(-50vw + 50%);
            position: relative;
            left: 0;
            right: 0;
        }

        .footer .container {
            max-width: 1140px;
            margin: 0 auto;
        }

        .footer h5 {
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 20px;
        }

        .footer-social .btn {
            background-color: #343a40;
            color: white;
            margin-right: 5px;
            width: 38px;
            height: 38px;
            padding: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .footer-social .btn:hover {
            background-color: var(--primary);
            color: var(--secondary);
        }

        .footer-contact li {
            margin-bottom: 15px;
        }

        .footer-contact .icon {
            color: var(--primary);
            margin-right: 10px;
        }

        .footer-links a {
            color: #dee2e6;
            text-decoration: none;
            transition: all 0.3s;
            display: block;
            margin-bottom: 10px;
        }

        .footer-links a:hover {
            color: var(--primary);
            padding-left: 5px;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
            margin-top: 30px;
            text-align: center;
            font-size: 0.9rem;
            color: #adb5bd;
        }

        .floating-icons {
            position: fixed;
            top: 30%;
            right: 5%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        .floating-icons .icon {
            background: white;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            padding: 8px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .floating-icons .icon img {
            width: 30px;
            height: 30px;
        }

        .floating-icons .icon:hover {
            transform: scale(1.2) translateX(-10px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .navbar-links .nav-link {
            color: #dee2e6;
            text-decoration: none;
            transition: all 0.3s;
        }

        .navbar-links .nav-link:hover {
            color: var(--primary);
            transform: translateX(5px);
        }

        .navbar-links .nav-item {
            margin: 0 10px;
        }

        .navbar .bi-chevron-right {
            color: var(--primary);
        }

        @media (max-width: 767.98px) {
            .calculator-container {
                padding: 20px;
            }

            .footer-section {
                margin-bottom: 30px;
            }
        }
        .vehicle-options {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin-top: 15px;
}

.vehicle-option {
    border: 2px solid #dee2e6;
    border-radius: 10px;
    padding: 10px;
    cursor: pointer;
    transition: transform 0.2s ease, border-color 0.3s ease;
}

@media (min-width: 768px) {
    .vehicle-options {
        grid-template-columns: repeat(4, 1fr);
    }

    .vehicle-option {
        padding: 15px;
    }
}

.vehicle-option:hover {
    transform: translateY(-5px);
}

.vehicle-option.selected {
    border-color: var(--primary);
    background-color: rgba(255, 191, 0, 0.1);
}

.vehicle-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}
.vehicle-option .form-check {
    padding-left: 0;
}

.vehicle-option .form-check-input {
    margin-top: 10px;
}
.taxi-png {
    width: 50px;
    height: 50px;
    object-fit: contain;
    transition: transform 0.3s ease;
}

.taxi-png:hover {
    transform: scale(1.2);
}

.vehicle-text {
    font-weight: bold;
    text-align: center;
    color: var(--secondary);
}

.vehicle-rate {
    font-weight: bold;
    color: var(--primary);
    background-color: rgba(255, 191, 0, 0.1);
    padding: 4px 10px;
    border-radius: 20px;
}

.form-check-input {
    display: none;
}

@media (max-width: 767.98px) {
    .vehicle-option {
        width: 100%;
        max-width: 100%;
    }
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.animate-bounce {
    animation: bounce 0.5s ease;
}
<!-- Route visualization styles to add to the <style> section -->
.route-visualization {
    margin: 20px 0;
    padding: 15px;
    border-radius: 10px;
    background-color: #f8f9fa;
    border-left: 4px solid var(--primary);
}

.journey-path {
    display: flex;
    flex-direction: column;
    position: relative;
    margin: 20px 0;
    padding-left: 35px;
}

.path-point {
    position: relative;
    padding: 10px 15px;
    margin-bottom: 15px;
    border-radius: 8px;
    background-color: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    z-index: 2;
    display: flex;
    align-items: center;
}

.path-point.pickup {
    border-left: 4px solid #28a745;
}

.path-point.destination {
    border-left: 4px solid #dc3545;
}

.path-point.intermediate {
    border-left: 4px solid #0d6efd;
}

.path-point.return {
    border-left: 4px solid #28a745;
    font-style: italic;
}

.point-icon {
    position: absolute;
    left: -35px;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background-color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.point-icon.pickup-icon {
    background-color: #28a745;
    color: white;
}

.point-icon.destination-icon {
    background-color: #dc3545;
    color: white;
}

.point-icon.intermediate-icon {
    background-color: #0d6efd;
    color: white;
}

.point-icon.return-icon {
    background-color: #28a745;
    color: white;
}

.path-line {
    position: absolute;
    left: 15px; /* Center of the point icons */
    top: 30px;
    bottom: 30px;
    width: 2px;
    background-color: #dee2e6;
    z-index: 1;
}

.point-details {
    margin-left: 10px;
    flex-grow: 1;
}

.point-distance {
    font-size: 0.85rem;
    color: #6c757d;
    margin-top: 3px;
}

.point-name {
    font-weight: bold;
    margin-bottom: 0;
}

@media (max-width: 767.98px) {
    .journey-path {
        padding-left: 25px;
    }

    .point-icon {
        left: -25px;
        width: 24px;
        height: 24px;
        font-size: 0.8rem;
    }
}
.trip-type .btn {
    background-color: white !important;
    color: #495057 !important;
}

/* Only package button gets the yellow highlight */
#packageBtn {
    background-color: #ffc107 !important;
    color: #212529 !important;
}
    </style>
</head>
<body>


    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="Mayiltaxifont.png" alt="Mayil Taxi Logo" height="40">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto navbar-links">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html"><i class="bi bi-chevron-right me-2"></i>Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="service.html"><i class="bi bi-chevron-right me-2"></i>Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html"><i class="bi bi-chevron-right me-2"></i>Book Now</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- LOGO -->
    <div class="container mt-4">
        <div class="logo-container">
            <img src="1.png" alt="Mayil Taxi Logo" class="img-fluid">
        </div>

        <!-- Step 1: Trip Type -->
        <div class="mb-4">
        <label class="form-label fw-bold"><i class="bi bi-signpost-2-fill me-2"></i>Trip Type</label>
        <div class="trip-type btn-group w-100" role="group">
            <a href="index.html#drop" id="dropBtn" class="btn" style="background-color: white; color: #495057; border: 2px solid #dee2e6; transition: all 0.3s;">Drop Trip</a>
            <a href="index.html#round" id="roundBtn" class="btn" style="background-color: white; color: #495057; border: 2px solid #dee2e6; transition: all 0.3s;">Round Trip</a>
            <a href="#" id="packageBtn" class="btn" style="background-color: #ffc107; color: #212529; border: 2px solid #dee2e6; transition: all 0.3s;">Package Trip</a>
        </div>
    </div>


        <!-- Distance Calculator Container -->
        <div class="booking-container">
            <h2 class="mb-4"><i class="bi bi-geo-alt-fill me-2"></i>Package Trip</h2>

            <div class="row mb-4">
      <div class="col-md-6">
          <div class="mb-3">
              <label for="pickup" class="form-label fw-bold">Pickup Location:</label>
              <input type="text" class="form-control" id="pickup" placeholder="Enter pickup location">
          </div>
      </div>
      <div class="col-md-6">
          <div class="mb-3">
              <label for="destination" class="form-label fw-bold">Destination:</label>
              <input type="text" class="form-control" id="destination" placeholder="Enter destination">
          </div>
      </div>
  </div>
  <div class="row mb-3">
      <div class="col-md-6">
          <label for="pickup-datetime" class="form-label">Pickup Date & Time*</label>
          <input type="datetime-local" class="form-control" id="pickup-datetime" required>
      </div>
      <div class="col-md-6">
          <label for="drop-date" class="form-label">Drop Date*</label>
          <input type="date" class="form-control" id="drop-date" required>
      </div>
  </div>
  <!-- Add this new section for waypoints -->
  <div id="waypoints-container">
      <!-- Waypoints will be added here dynamically -->
  </div>

  <!-- Replace the current buttons with these -->
  <center>
<div class="d-grid gap-2 d-md-block mb-4">
    <button id="add-waypoint" class="btn btn-calculate me-md-2"><i class="bi bi-plus-circle me-2"></i>Add Intermediate Stop</button>

    <button id="reset" class="btn btn-reset"><i class="bi bi-arrow-repeat me-2"></i>Reset</button>
</div>
</center>

<!-- Vehicle Type Selection (Add this section) -->
<div class="mb-4">
    <label class="form-label fw-bold"><i class="bi bi-car-front-fill me-2"></i>Vehicle Type</label>

    <div class="vehicle-options">
        <!-- Hatchback Option -->
        <div class="vehicle-option selected" onclick="selectVehicle(this, 'hatchback')">
            <div class="form-check">
                <input class="form-check-input" type="radio" name="vehicleType" id="hatchback" value="hatchback" checked>
                <div class="vehicle-info">
                    <div class="vehicle-text">
                        <label class="form-check-label fw-bold" for="hatchback">4+1 Hatchback</label>
                    </div>
                    <img src="Hatchback.png" class="taxi-png" alt="Hatchback Icon">
                    <div class="vehicle-rate">₹13/km</div>
                </div>
            </div>
        </div>

        <!-- Sedan Option -->
        <div class="vehicle-option" onclick="selectVehicle(this, 'sedan')">
            <div class="form-check">
                <input class="form-check-input" type="radio" name="vehicleType" id="sedan" value="sedan">
                <div class="vehicle-info">
                    <div class="vehicle-text">
                        <label class="form-check-label fw-bold" for="sedan">4+1 Sedan</label>
                    </div>
                    <img src="Sedan.png" class="taxi-png" alt="Sedan Icon">
                    <div class="vehicle-rate">₹14/km</div>
                </div>
            </div>
        </div>

        <!-- Ertiga Option -->
        <div class="vehicle-option" onclick="selectVehicle(this, 'ertiga')">
            <div class="form-check">
                <input class="form-check-input" type="radio" name="vehicleType" id="ertiga" value="ertiga">
                <div class="vehicle-info">
                    <div class="vehicle-text">
                        <label class="form-check-label fw-bold" for="ertiga">6+1 Ertiga/Rumion</label>
                    </div>
                    <img src="SUV.png" class="taxi-png" alt="Ertiga Icon">
                    <div class="vehicle-rate">₹18/km</div>
                </div>
            </div>
        </div>

        <!-- Innova/Crysta Option -->
        <div class="vehicle-option" onclick="selectVehicle(this, 'crysta')">
            <div class="form-check">
                <input class="form-check-input" type="radio" name="vehicleType" id="crysta" value="crysta">
                <div class="vehicle-info">
                    <div class="vehicle-text">
                        <label class="form-check-label fw-bold" for="crysta">7+1 Innova</label>
                    </div>
                    <img src="SUV.png" class="taxi-png" alt="Innova Icon">
                    <div class="vehicle-rate">₹20/km</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Estimate Fate -->

<br>
<center>
<div class="d-grid gap-2 d-md-block mb-4 ">
    <button id="calculate" class="btn btn-calculate me-md-2 "><i class="bi bi-calculator-fill me-2"></i>Estimate Fare</button>
</div>
</center>

<br>
            <!-- Map Container -->
            <div id="map"></div>

            <!-- Results Section -->
            <div id="results" class="results" style="display: none;">
                <h4 class="mb-3">Route Details</h4>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>From:</strong> <span id="from-address"></span></p>
                        <p><strong>To:</strong> <span id="to-address"></span></p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Distance:</strong> <span id="total-distance"></span></p>
                        <p><strong>Estimated Duration:</strong> <span id="total-duration"></span></p>
                    </div>
                </div>
            </div>

            <!-- Add this after the fare estimation section in the calculateRoute function -->
            <br>
            <div class="text-center mt-3">
                <button id="book-now" class="btn btn-calculate me-md-2">
                    <i class="bi bi-calendar-plus me-2"></i>Book Now
                </button>
            </div>
            <br>
            <!-- Add this HTML form right after the "Journey Summary" section in your results display -->
            <div id="booking-form-container" class="mt-4" style="display: none;">
      <div class="booking-form p-4" style="background-color: #f8f9fa; border-radius: 10px; border-left: 4px solid var(--primary);">
          <h4><i class="bi bi-calendar-check me-2"></i>Book Your Package Trip</h4>
          <form id="booking-form">
              <div class="row mb-3">
                  <div class="col-md-6">
                      <label for="customer-name" class="form-label">Name*</label>
                      <input type="text" class="form-control" id="customer-name" required>
                  </div>
                  <div class="col-md-6">
                      <label for="customer-phone" class="form-label">Phone Number*</label>
                      <input type="tel" class="form-control" id="customer-phone" required>
                  </div>
              </div>
              <div class="row mb-3">
                  <div class="col-md-6">
                      <label for="customer-email" class="form-label">Email</label>
                      <input type="email" class="form-control" id="customer-email">
                  </div>
                  <div class="col-md-6">
                      <label for="vehicle-type-hidden" class="form-label">Vehicle Type</label>
                      <input type="text" class="form-control" id="vehicle-type-hidden" readonly>
                  </div>
              </div>
              <div class="mb-3">
                  <label for="customer-note" class="form-label">Additional Notes</label>
                  <textarea class="form-control" id="customer-note" rows="3" placeholder="Any special requests or information..."></textarea>
              </div>

              <!-- Hidden fields to store booking information -->
              <input type="hidden" id="route-from">
              <input type="hidden" id="route-to">
              <input type="hidden" id="route-waypoints">
              <input type="hidden" id="total-distance-hidden">
              <input type="hidden" id="estimated-fare-hidden">

              <div class="text-center mt-4">
                  <button type="submit" id="submit-booking" class="btn btn-calculate px-5">
                      <i class="bi bi-send me-2"></i>Submit Booking
                  </button>

                  <button type="button" id="cancel-booking" class="btn btn-reset ms-2">
                      <i class="bi bi-x-circle me-2"></i>Cancel
                  </button>
              </div>
          </form>
          <div id="booking-success" class="alert alert-success mt-3" style="display: none;">
              <i class="bi bi-check-circle-fill me-2"></i>Booking successfully submitted! We'll contact you soon.
          </div>
          <div id="booking-error" class="alert alert-danger mt-3" style="display: none;">
              <i class="bi bi-exclamation-triangle-fill me-2"></i>There was an error submitting your booking. Please try again or contact us directly.
          </div>
      </div>
  </div>
        </div>
    </div>



    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4 mb-lg-0">
                    <h5>About Mayil Taxi</h5>
                    <p>Mayil Taxi provides comfortable and reliable taxi services in Coimbatore and across Tamil Nadu. We specialize in both one-way drop and multi-day round trip services.</p>
                    <div class="footer-social">
                        <a href="https://wa.me/919488840332" class="btn rounded-circle" title="WhatsApp" target="_blank" rel="noopener noreferrer">
                            <i class="bi bi-whatsapp"></i>
                        </a>
                        <a href="mailto:MayilTaxi@gmail.com" class="btn rounded-circle" title="Email">
                            <i class="bi bi-envelope"></i>
                        </a>
                        <a href="https://maps.app.goo.gl/?q=5A+KRISHNA+SWAMINAGAR+CHINNAMAL+LAYOUT+KK+PUDUR+COIMBATORE+38" class="btn rounded-circle" title="Location" target="_blank" rel="noopener noreferrer">
                            <i class="bi bi-geo-alt"></i>
                        </a>
                        <a href="#" class="btn rounded-circle" title="Instagram" target="_blank" rel="noopener noreferrer">
                            <i class="bi bi-instagram"></i>
                        </a>
                    </div>
                </div>

                <div class="col-lg-4 mb-4 mb-lg-0">
                    <h5>Contact Us</h5>
                    <ul class="list-unstyled footer-contact">
                        <li>
                            <i class="bi bi-telephone-fill icon"></i>
                            <span>9488840332</span>
                        </li>
                        <li>
                            <i class="bi bi-envelope-fill icon"></i>
                            <span>mayiltaxi@gmail.com</span>
                        </li>
                        <li>
                            <i class="bi bi-geo-alt-fill icon"></i>
                            <span>MADURAI & COIMBATORE</span>
                        </li>
                    </ul>
                </div>

                <div class="col-lg-4">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled footer-links">
                        <li><a href="index.html"><i class="bi bi-chevron-right me-2"></i>Home</a></li>
                        <li><a href="service.html"><i class="bi bi-chevron-right me-2"></i>Services</a></li>
                        <li><a href="index.html"><i class="bi bi-chevron-right me-2"></i>Book Now</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 Mayil Taxi. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Floating Icons -->
    <div class="floating-icons">
        <a href="https://wa.me/919488840240" target="_blank" class="icon whatsapp" title="WhatsApp">
            <img src="https://img.icons8.com/ios-filled/50/25D366/whatsapp.png" alt="WhatsApp">
        </a>
        <a href="#" target="_blank" class="icon instagram" title="Instagram">
            <img src="https://img.icons8.com/ios-filled/50/E1306C/instagram-new.png" alt="Instagram">
        </a>
        <a href="tel:+919488840240" class="icon call" title="Call">
            <img src="https://img.icons8.com/ios-filled/50/000000/phone.png" alt="Call">
        </a>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>

    // Script to handle trip type selection and URL fragments
    document.addEventListener('DOMContentLoaded', function() {
      // Check if we're using the button version or the radio button version
      const usingRadioButtons = document.querySelector('.btn-check') !== null;

      // Function to set active state based on trip type
      function setActiveTripType(tripType) {
        if (usingRadioButtons) {
          // For the radio button version
          document.getElementById(tripType).checked = true;

          // Update the active class on labels
          document.querySelectorAll('.btn-outline-primary').forEach(btn => {
            if (btn.getAttribute('for') === tripType) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          });
        } else {
          // For the anchor tag version
          const buttons = {
            'drop': document.getElementById('dropBtn'),
            'round': document.getElementById('roundBtn'),
            'package': document.getElementById('packageBtn')
          };

          // Update active states
          Object.keys(buttons).forEach(key => {
            if (key === tripType && buttons[key]) {
              buttons[key].classList.add('active');
              buttons[key].style.backgroundColor = '';
              buttons[key].style.color = '';
            } else if (buttons[key]) {
              buttons[key].classList.remove('active');
              buttons[key].style.backgroundColor = 'white';
              buttons[key].style.color = '#495057';
            }
          });
        }
      }

      // Check URL hash on page load
      function checkURLFragment() {
        const hash = window.location.hash.substring(1); // Remove the # character
        if (hash === 'round') {
          setActiveTripType('round');
        } else if (hash === 'package') {
          setActiveTripType('package');
        } else {
          setActiveTripType('drop');
        }
      }

      // Run on page load
      checkURLFragment();

      // Set up event listeners for the anchor tag version
      if (!usingRadioButtons) {
        if (document.getElementById('roundBtn')) {
          document.getElementById('roundBtn').addEventListener('click', function(e) {
            // Don't prevent default as we want the page navigation to happen
            // The hash in the URL will be processed on the next page load
          });
        }

        if (document.getElementById('dropBtn')) {
          document.getElementById('dropBtn').addEventListener('click', function(e) {
            // Similar approach for consistency
          });
        }

        if (document.getElementById('packageBtn')) {
          document.getElementById('packageBtn').addEventListener('click', function(e) {
            // Similar approach for consistency
          });
        }
      }

      // Set up event listeners for the radio button version
      if (usingRadioButtons) {
        document.querySelectorAll('.btn-check').forEach(radio => {
          radio.addEventListener('change', function() {
            setActiveTripType(this.id);
            // Update URL hash without reloading the page
            history.pushState(null, null, '#' + this.id);
          });
        });
      }

      // Handle browser back/forward navigation
      window.addEventListener('popstate', checkURLFragment);
    });



    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwYoDCeJl_FOpnYz1HLAKHvmOTr00GHz7_-Osdoe75-b9Tnr9m9cKeKaAlZKbz5K2EO/exec";
const SHEET_ID = "1OMu8lUxVgmaQg58VthxI2lZHZuyTvW33TGhPdqt7mn8";

// Book Now button handler
document.addEventListener('DOMContentLoaded', function() {
    // This will be initialized when the "Book Now" button is added dynamically
    document.body.addEventListener('click', function(e) {
        if (e.target && e.target.id === 'book-now' || e.target.parentElement && e.target.parentElement.id === 'book-now') {
            showBookingForm();
        }

        if (e.target && e.target.id === 'cancel-booking') {
            hideBookingForm();
        }
    });

    // Handle form submission
    document.getElementById('booking-form').addEventListener('submit', function(e) {
        e.preventDefault();
        submitBooking();
    });
});

// Update the showBookingForm function to include number of days
function showBookingForm() {
    // Get and store trip details in hidden fields
    const pickup = document.getElementById("pickup").value;
    const destination = document.getElementById("destination").value;

    // Collect waypoints
    const waypointInputs = document.querySelectorAll("#waypoints-container input");
    let waypointsText = [];
    for (let input of waypointInputs) {
        if (input.value.trim() !== "") {
            waypointsText.push(input.value);
        }
    }

    // Get total distance and estimated fare from the results section
    const totalDistanceText = document.getElementById("total-distance").textContent;
    const fareText = document.getElementById("fare-estimation").textContent;
    const daysText = document.getElementById("total-days").textContent;

    // Get selected vehicle type
    let vehicleType = "Hatchback";
    if (document.getElementById('sedan').checked) {
        vehicleType = "Sedan";
    } else if (document.getElementById('ertiga').checked) {
        vehicleType = "Ertiga/Rumion";
    } else if (document.getElementById('crysta').checked) {
        vehicleType = "Innova";
    }

    // Set values in hidden fields
    document.getElementById("route-from").value = pickup;
    document.getElementById("route-to").value = destination;
    document.getElementById("route-waypoints").value = waypointsText.join(" | ");
    document.getElementById("total-distance-hidden").value = totalDistanceText;
    document.getElementById("estimated-fare-hidden").value = fareText;
    document.getElementById("vehicle-type-hidden").value = vehicleType;

    // Show the booking form
    document.getElementById("booking-form-container").style.display = "block";

    // Scroll to the booking form
    document.getElementById("booking-form-container").scrollIntoView({ behavior: 'smooth' });
}
function hideBookingForm() {
    document.getElementById("booking-form-container").style.display = "none";
    document.getElementById("booking-form").reset();
    document.getElementById("booking-success").style.display = "none";
    document.getElementById("booking-error").style.display = "none";
}

// Also update the submitBooking function to include the new day-based fare calculation
function submitBooking() {
    // Show loading state
    const submitBtn = document.getElementById("submit-booking");
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Processing...';
    submitBtn.disabled = true;

    // Format pickup date and time for better readability
    const pickupDateTime = new Date(document.getElementById("pickup-datetime").value);
    const formattedPickupDateTime = pickupDateTime.toLocaleDateString() + ' ' +
        pickupDateTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', hour12: true});

    // Format drop date
    const dropDate = new Date(document.getElementById("drop-date").value);
    const formattedDropDate = dropDate.toLocaleDateString();

    // Calculate number of days
    const diffTime = Math.abs(dropDate - pickupDateTime);
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;

    // Create data object for the API
    const data = {
        sheetId: SHEET_ID,
        sheetName: "Package Bookings",
        data: {
            timestamp: new Date().toLocaleString(),
            name: document.getElementById("customer-name").value,
            phone: document.getElementById("customer-phone").value,
            email: document.getElementById("customer-email").value || "N/A",
            pickupDatetime: formattedPickupDateTime,
            dropDate: formattedDropDate,
            numberOfDays: diffDays,
            pickup: document.getElementById("route-from").value,
            destination: document.getElementById("route-to").value,
            waypoints: document.getElementById("route-waypoints").value || "None",
            vehicleType: document.getElementById("vehicle-type-hidden").value,
            totalDistance: document.getElementById("total-distance-hidden").value,
            estimatedFare: document.getElementById("estimated-fare-hidden").value,
            notes: document.getElementById("customer-note").value || "None"
        }
    };

    // Send data to Google Sheet
    fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(data),
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Reset button state
        submitBtn.innerHTML = originalBtnText;
        submitBtn.disabled = false;

        // Show success message
        document.getElementById("booking-success").style.display = "block";
        document.getElementById("booking-error").style.display = "none";

        // Reset form after 3 seconds
        setTimeout(() => {
            document.getElementById("booking-form").reset();
        }, 3000);
    })
    .catch(error => {
        console.error('Error:', error);

        // Reset button state
        submitBtn.innerHTML = originalBtnText;
        submitBtn.disabled = false;

        // Show error message
        document.getElementById("booking-error").style.display = "block";
        document.getElementById("booking-success").style.display = "none";
    });
}
// Vehicle selection function
function selectVehicle(element, id) {
  // Remove selected class from all options
  document.querySelectorAll('.vehicle-option').forEach(option => {
      option.classList.remove('selected');
      option.querySelector('.taxi-png')?.classList.remove('animate-bounce');
  });

  // Add selected class to clicked option
  element.classList.add('selected');
  element.querySelector('.taxi-png')?.classList.add('animate-bounce');

  // Check the radio button
  document.getElementById(id).checked = true;
}

      let map;
      let directionsService;
      let directionsRenderer;
      let autocompletePickup;
      let autocompleteDestination;
      let waypointAutocompletes = [];

      // Initialize Google Maps
      function initMap() {
          directionsService = new google.maps.DirectionsService();
          directionsRenderer = new google.maps.DirectionsRenderer();

          map = new google.maps.Map(document.getElementById("map"), {
              center: { lat: 11.0168, lng: 76.9558 }, // Coimbatore coordinates
              zoom: 13,
          });

          directionsRenderer.setMap(map);

          // Initialize autocomplete for pickup and destination
          autocompletePickup = new google.maps.places.Autocomplete(document.getElementById("pickup"));
          autocompleteDestination = new google.maps.places.Autocomplete(document.getElementById("destination"));

          // Add event listeners
          document.getElementById("add-waypoint").addEventListener("click", addWaypoint);
          document.getElementById("calculate").addEventListener("click", calculateRoute);
          document.getElementById("reset").addEventListener("click", resetForm);
      }

      // Add a new waypoint input
      function addWaypoint() {
          const waypointsContainer = document.getElementById("waypoints-container");
          const waypointCount = waypointsContainer.children.length + 1;

          const waypointDiv = document.createElement("div");
          waypointDiv.classList.add("row", "mb-3");

          waypointDiv.innerHTML = `
              <div class="col-md-10">
                  <div class="mb-3">
                      <label for="waypoint${waypointCount}" class="form-label fw-bold">Intermediate Stop ${waypointCount}:</label>
                      <input type="text" class="form-control" id="waypoint${waypointCount}" placeholder="Enter intermediate location">
                  </div>
              </div>
              <div class="col-md-2 d-flex align-items-end mb-3">
                  <button class="btn btn-danger remove-waypoint" data-index="${waypointCount - 1}"><i class="bi bi-x-circle"></i></button>
              </div>
          `;

          waypointsContainer.appendChild(waypointDiv);

          // Initialize autocomplete for the new waypoint
          const waypointInput = document.getElementById(`waypoint${waypointCount}`);
          const autocomplete = new google.maps.places.Autocomplete(waypointInput);
          waypointAutocompletes.push(autocomplete);

          // Add event listener to remove button
          waypointDiv.querySelector(".remove-waypoint").addEventListener("click", function() {
              const index = parseInt(this.getAttribute("data-index"));
              removeWaypoint(waypointDiv, index);
          });
      }

      // Remove a waypoint
      function removeWaypoint(waypointDiv, index) {
          waypointDiv.remove();
          waypointAutocompletes.splice(index, 1);

          // Update the indices for remaining waypoints
          const removeButtons = document.querySelectorAll("#waypoints-container .remove-waypoint");
          for (let i = 0; i < removeButtons.length; i++) {
              removeButtons[i].setAttribute("data-index", i);
          }

          // Update labels
          const waypointLabels = document.querySelectorAll("#waypoints-container label");
          for (let i = 0; i < waypointLabels.length; i++) {
              waypointLabels[i].textContent = `Intermediate Stop ${i + 1}:`;
              waypointLabels[i].setAttribute("for", `waypoint${i + 1}`);
          }

          // Update input IDs
          const waypointInputs = document.querySelectorAll("#waypoints-container input");
          for (let i = 0; i < waypointInputs.length; i++) {
              waypointInputs[i].id = `waypoint${i + 1}`;
          }
      }

      // Vehicle selection function
    function selectVehicle(element, id) {
      // Remove selected class from all options
      document.querySelectorAll('.vehicle-option').forEach(option => {
          option.classList.remove('selected');
          option.querySelector('.taxi-png')?.classList.remove('animate-bounce');
      });

      // Add selected class to clicked option
      element.classList.add('selected');
      element.querySelector('.taxi-png')?.classList.add('animate-bounce');

      // Check the radio button
      document.getElementById(id).checked = true;
    }

    // Update calculateRoute function to include day rent calculation
function calculateRoute() {
    const pickup = document.getElementById("pickup").value;
    const destination = document.getElementById("destination").value;
    const pickupDateTime = document.getElementById("pickup-datetime").value;
    const dropDate = document.getElementById("drop-date").value;

    if (!pickup || !destination || !pickupDateTime || !dropDate) {
        alert("Please enter all required fields");
        return;
    }

    // Calculate number of days for the trip
    const startDate = new Date(pickupDateTime);
    const endDate = new Date(dropDate);

    // Calculate the difference in days (add 1 because both pickup and drop dates count as days)
    const diffTime = Math.abs(endDate - startDate);
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;

    if (diffDays < 1) {
        alert("Invalid date selection. The drop date should be on or after the pickup date.");
        return;
    }

    // Get waypoints
    const waypointInputs = document.querySelectorAll("#waypoints-container input");
    const waypoints = [];

    for (let input of waypointInputs) {
        if (input.value.trim() !== "") {
            waypoints.push({
                location: input.value,
                stopover: true
            });
        }
    }

    // Create route request
    const request = {
        origin: pickup,
        destination: destination,
        waypoints: waypoints,
        optimizeWaypoints: false,
        travelMode: google.maps.TravelMode.DRIVING
    };

    // Get route from Directions Service
    directionsService.route(request, function(result, status) {
        if (status === google.maps.DirectionsStatus.OK) {
            directionsRenderer.setDirections(result);

            // Calculate total distance and duration
            let totalDistance = 0;
            let totalDuration = 0;
            const legs = result.routes[0].legs;
            let resultHtml = "<h4 class='mb-3'>Route Details</h4>";

            for (let i = 0; i < legs.length; i++) {
                totalDistance += legs[i].distance.value;
                totalDuration += legs[i].duration.value;
            }

            // Create a second request for return journey from destination back to pickup
            const returnRequest = {
                origin: destination,
                destination: pickup,
                travelMode: google.maps.TravelMode.DRIVING
            };

            directionsService.route(returnRequest, function(returnResult, returnStatus) {
                if (returnStatus === google.maps.DirectionsStatus.OK) {
                    // Add the return distance to the total
                    const returnLeg = returnResult.routes[0].legs[0];
                    const returnDistance = returnLeg.distance.value;
                    const returnDuration = returnLeg.duration.value;

                    // Add return journey to totals
                    totalDistance += returnDistance;
                    totalDuration += returnDuration;

                    // Convert meters to kilometers
                    const totalDistanceKm = totalDistance / 1000;
                    const totalDistanceText = totalDistanceKm.toFixed(2) + " km";

                    // Convert seconds to hours and minutes
                    const hours = Math.floor(totalDuration / 3600);
                    const minutes = Math.floor((totalDuration % 3600) / 60);
                    const durationText = `${hours > 0 ? hours + ' hr ' : ''}${minutes} min`;

                    // Vehicle rates per km and day rent
                    let ratePerKm = 13; // Default rate (Hatchback)
                    let dayRent = 1700; // Default day rent for Hatchback
                    let vehicleType = "Hatchback";

                    // Get selected vehicle type
                    if (document.getElementById('sedan').checked) {
                        ratePerKm = 14;
                        dayRent = 1800;
                        vehicleType = "Sedan";
                    } else if (document.getElementById('ertiga').checked) {
                        ratePerKm = 18;
                        dayRent = 2300;
                        vehicleType = "Ertiga/Rumion";
                    } else if (document.getElementById('crysta').checked) {
                        ratePerKm = 20;
                        dayRent = 2500;
                        vehicleType = "Innova";
                    }

                    // Calculate fare based on distance and days
                    const distanceCost = Math.round(totalDistanceKm * ratePerKm);
                    const dayCost = dayRent * diffDays;
                    const estimatedFare = distanceCost + dayCost;

                    // Display route details
                    resultHtml += `
                    <div class="row">
                        <div class="col-md-6">
                            <div style="background-color: #fff3cd; border-left: 5px solid #ffecb5; padding: 15px; border-radius: 4px;">
                                <strong><em>Note:</em></strong> <em>The actual bill may vary based on additional kilometers traveled, waiting time, night charges, hill station charges, and inter-state permits.</em>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <p><strong>Total Distance:</strong> <span id="total-distance">${totalDistanceText}</span> (includes return)</p>
                            <p><strong>Number of Days:</strong> <span id="total-days">${diffDays}</span></p>

                            <p><strong>Estimated Fare:</strong> <span id="fare-estimation">₹${estimatedFare}</span></p>
                            <p class="text-muted"><small>Additional day: ₹${dayRent} | Additional km: ₹${ratePerKm}/km</small></p>
                        </div>
                    </div>`;

                    // Create visual representation of the journey path
                    resultHtml += `
                    <div class="route-visualization mt-4">
                        <h5>Journey Path</h5>
                        <div class="journey-path">
                            <div class="path-line"></div>
                            <!-- Pickup Point -->
                            <div class="path-point pickup">
                                <div class="point-icon pickup-icon">
                                    <i class="bi bi-geo-alt-fill"></i>
                                </div>
                                <div class="point-details">
                                    <div class="point-name">Pickup: ${legs[0].start_address.split(',')[0]}</div>
                                    <div class="point-distance">Starting Point</div>
                                </div>
                            </div>`;

                    // Add intermediate stops if any
                    for (let i = 1; i < legs.length; i++) {
                        resultHtml += `
                            <!-- Intermediate Stop ${i} -->
                            <div class="path-point intermediate">
                                <div class="point-icon intermediate-icon">
                                    <i class="bi bi-signpost-2"></i>
                                </div>
                                <div class="point-details">
                                    <div class="point-name">Stop ${i}: ${legs[i].start_address.split(',')[0]}</div>
                                    <div class="point-distance">${legs[i-1].distance.text} • ${legs[i-1].duration.text} from previous stop</div>
                                </div>
                            </div>`;
                    }

                    // Add destination
                    resultHtml += `
                            <!-- Destination -->
                            <div class="path-point destination">
                                <div class="point-icon destination-icon">
                                    <i class="bi bi-flag-fill"></i>
                                </div>
                                <div class="point-details">
                                    <div class="point-name">Destination: ${legs[legs.length-1].end_address.split(',')[0]}</div>
                                    <div class="point-distance">${legs[legs.length-1].distance.text} • ${legs[legs.length-1].duration.text} from previous stop</div>
                                </div>
                            </div>

                            <!-- Return Journey -->
                            <div class="path-point return">
                                <div class="point-icon return-icon">
                                    <i class="bi bi-house-fill"></i>
                                </div>
                                <div class="point-details">
                                    <div class="point-name">Return: Back to ${legs[0].start_address.split(',')[0]}</div>
                                    <div class="point-distance">${returnLeg.distance.text} • ${returnLeg.duration.text} from destination</div>
                                </div>
                            </div>
                        </div>
                    </div>`;

                    // Add overall notes about the journey
                    resultHtml += `
                    <div class="mt-3">
                        <h5>Journey Summary</h5>
                        <ul>
                            <li>Package trip with ${vehicleType} for ${diffDays} day${diffDays > 1 ? 's' : ''}</li>
                            <li>Trip includes ${waypoints.length} intermediate stop${waypoints.length !== 1 ? 's' : ''}</li>
                            <li>Return journey is included in the fare calculation</li>
                            <li>Total travel time may vary based on traffic conditions</li>
                        </ul>
                    </div>`;

                    document.getElementById("results").innerHTML = resultHtml;
                    document.getElementById("results").style.display = "block";

                    // Show the "Book Now" button
                    if (!document.getElementById("book-now")) {
                        const bookButtonDiv = document.createElement("div");
                        bookButtonDiv.className = "text-center mt-3";
                        bookButtonDiv.innerHTML = `
                            <button id="book-now" class="btn btn-calculate me-md-2">
                                <i class="bi bi-calendar-plus me-2"></i>Book Now
                            </button>
                        `;
                        document.getElementById("results").after(bookButtonDiv);
                    }
                } else {
                    alert("Could not calculate return directions: " + returnStatus);
                }
            });
        } else {
            alert("Could not calculate directions: " + status);
        }
    });
}

      // Reset the form
      function resetForm() {
          document.getElementById("pickup").value = "";
          document.getElementById("destination").value = "";

          // Clear waypoints
          document.getElementById("waypoints-container").innerHTML = "";
          waypointAutocompletes = [];

          // Clear results
          document.getElementById("results").style.display = "none";

          // Clear directions
          directionsRenderer.setDirections({routes: []});
      }
  </script>

  <!-- Make sure to include this in the Google Maps API script at the bottom -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBTm8unNAZY-We3a05qozpJMPgPJFvKk-8&libraries=places&callback=initMap" async defer></script>
</html>
